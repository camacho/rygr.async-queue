/*
Rygr Async Queue, v 0.0.1
Copyright (c)2014 Patrick Camacho
Distributed under MIT license
https://github.com/camacho/rygr.async-queue
 */
(function(){var r;r=require("q"),module.exports=function(){var n,t,e,o,i,a,c,u,f,l,d;if(f=[],c=Array.isArray||function(r){return"[object Array]"===Object.prototype.toString.call(r)},u=function(r){return"function"==typeof r},i=r.defer(),c(n)||(n=[n]),t=n.length+1,!c(o)){if(!u(o))throw new Error("Callbacks must be an array of functions");o=[o]}for(l=0,d=o.length;d>l;l++){if(e=o[l],!u(e))throw new Error("Callback is not a function");f.push({handle:e})}return a=function(){var e,o;return e=0,(o=function(a){var c,u,l;if(r.isPending(i.promise)){if(l=f[e++],!l)return a?i.reject(a):i.resolve(),void("function"==typeof done&&done(a));try{return c=l.handle.length,a?c===t+1?l.handle.apply(void 0,[a].concat(n,[o])):o(a):t+1>c?l.handle.apply(void 0,n.concat([o])):o()}catch(d){return u=d,o(u)}}})()},a(),i.promise}}).call(this);