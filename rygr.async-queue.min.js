/*
Rygr Async Queue, v 0.0.1
Copyright (c)2014 Patrick Camacho
Distributed under MIT license
https://github.com/camacho/rygr.async-queue
 */
(function(){var r;r=require("q"),module.exports=function(n,t,e){var o,i,a,c,u,f,l,h,p;if(l=[],u=Array.isArray||function(r){return"[object Array]"===Object.prototype.toString.call(r)},f=function(r){return"function"==typeof r},a=r.defer(),u(n)||(n=[n]),o=n.length+1,!u(t)){if(!f(t))throw new Error("Callbacks must be an array of functions");t=[t]}for(h=0,p=t.length;p>h;h++){if(i=t[h],!f(i))throw new Error("Callback is not a function");l.push({handle:i})}return c=function(){var t,i;return t=0,(i=function(c){var u,f,h;if(r.isPending(a.promise)){if(h=l[t++],!h)return c?a.reject(c):a.resolve(),void("function"==typeof e&&e(c));try{return u=h.handle.length,c?u===o+1?h.handle.apply(void 0,[c].concat(n,[i])):i(c):o+1>u?h.handle.apply(void 0,n.concat([i])):i()}catch(p){return f=p,i(f)}}})()},c(),a.promise}}).call(this);